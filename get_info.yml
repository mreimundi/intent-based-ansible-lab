- name: get Info
  hosts:
    - clab-4l2s-l1
#    - leaf
#    - spine
  tasks:
    - nokia.srl.jsonrpc_get:
        paths:
#        - path: /
#          datastore: running
#        - path: /platform/control[slot=A]/software-version
#          datastore: state
        - path: /system/lldp/interface[name=*]/neighbor
          datastore: state
      register: res
    - set_fact:
        lldp_nbrs: "{{ res.json.result[0].interface | items2dict(key_name='name', value_name='neighbor') }}"
    - set_fact:
        env: "{{ lookup('env', 'ENV') | default('') }}"
      failed_when: env == ""
      

#    - set_fact:
#        pv:
#          - path:  "{{ '/interface[name=' +  item.name + ']' }}"
#            value:  "{{ item.neighbor[0]['system-name'] }}"
#        update: "{{ update|default([]) + [ pv ] }}"
#      loop: "{{ lldp_nbrs.interface }}"
#      when: item.name is regex('^ethernet.*')
#
    - debug:
        var: res
